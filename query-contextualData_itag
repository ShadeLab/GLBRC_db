drop view if exists "16S iTag Contextual Data - all";
create view  [16S iTag Contextual Data - all]
as

select sampling.sampleID as "sampling ID", 
nucleic_acids.name as "Nucleic Acids Name",
plot.treatment,
nucleic_acids.source,
plot.plot_name,
plot.rep,

-- collect and hyphenate y/m/d and display as 'sampling_date' with 4 digit year and 2-digit month and day
printf('%4d-%02d-%02d', year, month, day) as sampling_Date,
time as "Sampling Time",
plant.height_mean_cm as "average plant height (cm)",
air_temp_c, 
soil_temp_c, 
weather,
sequencing.sequencing_type
from sampling
inner join nucleic_acids on sampling.sampleID = nucleic_acids.sampleID
inner join plot on plot.plotid = sampling.plotid
inner join sequencing on sequencing.name = nucleic_acids.name
inner join plant on plant.sampleid = sampling.sampleid

-- filter by sequencing type, only 16S. (could also filter by RNA or source or whatever else) 
where sampling.year = "2016"
and sequencing.sequencing_type like "%16S%"

--optional filter by NA source: and nucleic_acids.source = "Soil"
order by source;




select printf('%4d-%02d-%02d', year, month, day) as sampling_Date
from sampling;